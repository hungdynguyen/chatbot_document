INFO:     Will watch for changes in these directories: ['/root/chatbot/backend']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [63350] using WatchFiles
INFO:     Started server process [63360]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'utils/embedding_handler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [63360]
INFO:     Started server process [66019]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
🧠 Đang tải / khởi tạo embedding model …
✅ Embedding model sẵn sàng.
✅ File 'to_trinh_tin_dung.txt' đã được lưu thành công với tên '5dd9fe5a-8ad1-4e58-8789-b9ae410ea821.txt'
INFO:     127.0.0.1:60836 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'bao_cao_tai_chinh_va_ke_hoach_kinh_doanh.txt' đã được lưu thành công với tên '3f7d79e8-a49b-4694-90a0-c3ef3bbceb85.txt'
INFO:     127.0.0.1:60836 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'trich_xuat_he_thong_crm.txt' đã được lưu thành công với tên '18b1b1a7-0897-47d1-958d-2af1a7bf99b9.txt'
INFO:     127.0.0.1:60836 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'ho_so_phap_ly_doanh_nghiep.txt' đã được lưu thành công với tên 'c1a8ac5b-83c4-409c-a285-57c06b723ad7.txt'
INFO:     127.0.0.1:60836 - "POST /upload_file HTTP/1.1" 200 OK
INFO:     127.0.0.1:60836 - "OPTIONS /process_prompt HTTP/1.1" 200 OK
🚀 Nhận được yêu cầu xử lý cho 4 file với prompt: 'Trích xuất thông tin theo mẫu Báo cáo thẩm định.' và template: 'new_template'
   Các File ID: ['5dd9fe5a-8ad1-4e58-8789-b9ae410ea821', '3f7d79e8-a49b-4694-90a0-c3ef3bbceb85', '18b1b1a7-0897-47d1-958d-2af1a7bf99b9', 'c1a8ac5b-83c4-409c-a285-57c06b723ad7']
🚀 New collection: session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c
Đọc file:   0%|          | 0/4 [00:00<?, ?it/s]Đọc file:  25%|██▌       | 1/4 [00:13<00:40, 13.52s/it]Đọc file: 100%|██████████| 4/4 [00:13<00:00,  3.39s/it]
/root/chatbot/backend/utils/embedding_handler.py:89: LangChainDeprecationWarning: The class `Qdrant` was deprecated in LangChain 0.1.2 and will be removed in 0.5.0. Use :class:`~QdrantVectorStore` instead.
  qstore = Qdrant(
INFO: HTTP Request: PUT http://localhost:6333/collections/session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c/points?wait=true "HTTP/1.1 200 OK"
INFO: HTTP Request: PUT http://localhost:6333/collections/session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c/points?wait=true "HTTP/1.1 200 OK"
📄 Đã đọc 75 docs, chia thành 75 chunk.
⏳ Embedding & ghi Qdrant …
✅ Hoàn tất collection session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c
Các file đã được embedding vào collection: session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c
Sử dụng danh sách trường cho MẪU MỚI.
🚀 Bắt đầu quá trình trích xuất thông tin từ collection 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c' cho template 'new_template'...

--- VÒNG LẶP 1/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất, Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 2/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 3/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: BBC (Báo cáo bởi)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 4/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 5/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: CBC (Cán bộ chính)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 6/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID đề xuất
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 7/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 8/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày báo cáo
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 9/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 10/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày cập nhật
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 11/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Mục đích thẩm định
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 12/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: Cấp nơi, ID T24, Xếp hạng tín dụng, Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 13/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Cấp nơi, ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 14/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Cấp nơi
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 15/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 16/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID T24
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 17/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Xếp hạng tín dụng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 18/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 19/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày xếp hạng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 20/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...


✅ Quá trình trích xuất hoàn tất!
🔄 Cấu trúc lại dữ liệu cho mẫu mới...
INFO:     127.0.0.1:60836 - "POST /process_prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:50632 - "OPTIONS /clear_rag_session HTTP/1.1" 200 OK
INFO: HTTP Request: DELETE http://localhost:6333/collections/session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c "HTTP/1.1 200 OK"
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c
✅ RAG Collection 'session-de52d21f-8a0f-4c95-a2a4-f25fb67aa63c' đã được xóa thành công.
INFO:     127.0.0.1:50632 - "POST /clear_rag_session HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'utils/embedding_handler.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [66019]
INFO:     Started server process [67631]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
🧠 Đang tải / khởi tạo embedding model …
✅ Embedding model sẵn sàng.
✅ File 'to_trinh_tin_dung.txt' đã được lưu thành công với tên '4270538d-8bbb-4167-8e9d-ca3290dafa8e.txt'
INFO:     127.0.0.1:56418 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'bao_cao_tai_chinh_va_ke_hoach_kinh_doanh.txt' đã được lưu thành công với tên 'f01d5bad-a1c2-4551-af58-6f50f97b1698.txt'
INFO:     127.0.0.1:56418 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'trich_xuat_he_thong_crm.txt' đã được lưu thành công với tên '48a25554-154a-43ab-9ea4-165471e40ae8.txt'
INFO:     127.0.0.1:56418 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'ho_so_phap_ly_doanh_nghiep.txt' đã được lưu thành công với tên '7f71d98f-5b7a-4589-a4ec-2edd6eeda299.txt'
INFO:     127.0.0.1:56418 - "POST /upload_file HTTP/1.1" 200 OK
INFO:     127.0.0.1:45254 - "OPTIONS /process_prompt HTTP/1.1" 200 OK
🚀 Nhận được yêu cầu xử lý cho 4 file với prompt: 'Trích xuất thông tin theo mẫu Báo cáo thẩm định.' và template: 'new_template'
   Các File ID: ['4270538d-8bbb-4167-8e9d-ca3290dafa8e', 'f01d5bad-a1c2-4551-af58-6f50f97b1698', '48a25554-154a-43ab-9ea4-165471e40ae8', '7f71d98f-5b7a-4589-a4ec-2edd6eeda299']
🚀 New collection: session-61cec466-b5f7-4581-9a37-258a54b45e24
Đọc file:   0%|          | 0/4 [00:00<?, ?it/s]Đọc file:  25%|██▌       | 1/4 [00:08<00:25,  8.55s/it]Đọc file: 100%|██████████| 4/4 [00:08<00:00,  2.15s/it]
/root/chatbot/backend/utils/embedding_handler.py:92: LangChainDeprecationWarning: The class `Qdrant` was deprecated in LangChain 0.1.2 and will be removed in 0.5.0. Use :class:`~QdrantVectorStore` instead.
  qstore = Qdrant(
INFO: HTTP Request: PUT http://localhost:6333/collections/session-61cec466-b5f7-4581-9a37-258a54b45e24/points?wait=true "HTTP/1.1 200 OK"
⏳ Embedding & ghi Qdrant …
✅ Hoàn tất collection session-61cec466-b5f7-4581-9a37-258a54b45e24
Các file đã được embedding vào collection: session-61cec466-b5f7-4581-9a37-258a54b45e24
Sử dụng danh sách trường cho MẪU MỚI.
🚀 Bắt đầu quá trình trích xuất thông tin từ collection 'session-61cec466-b5f7-4581-9a37-258a54b45e24' cho template 'new_template'...

--- VÒNG LẶP 1/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất, Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 2/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 3/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: BBC (Báo cáo bởi)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 4/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 5/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: CBC (Cán bộ chính)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 6/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID đề xuất
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 7/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 8/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày báo cáo
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 9/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 10/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày cập nhật
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 11/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Mục đích thẩm định
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 12/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: Cấp nơi, ID T24, Xếp hạng tín dụng, Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 13/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Cấp nơi, ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 14/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Cấp nơi
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 15/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 16/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID T24
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 17/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Xếp hạng tín dụng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 18/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 19/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày xếp hạng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 20/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-61cec466-b5f7-4581-9a37-258a54b45e24'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...


✅ Quá trình trích xuất hoàn tất!
🔄 Cấu trúc lại dữ liệu cho mẫu mới...
INFO:     127.0.0.1:45254 - "POST /process_prompt HTTP/1.1" 200 OK
INFO:     127.0.0.1:45700 - "OPTIONS /clear_rag_session HTTP/1.1" 200 OK
INFO: HTTP Request: DELETE http://localhost:6333/collections/session-61cec466-b5f7-4581-9a37-258a54b45e24 "HTTP/1.1 200 OK"
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-61cec466-b5f7-4581-9a37-258a54b45e24
✅ RAG Collection 'session-61cec466-b5f7-4581-9a37-258a54b45e24' đã được xóa thành công.
INFO:     127.0.0.1:45700 - "POST /clear_rag_session HTTP/1.1" 200 OK
✅ File 'to_trinh_tin_dung.txt' đã được lưu thành công với tên 'b70f4322-3dce-4d7c-8f75-f5235d776317.txt'
INFO:     127.0.0.1:55722 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'bao_cao_tai_chinh_va_ke_hoach_kinh_doanh.txt' đã được lưu thành công với tên '4b19fdaf-1e13-4007-9148-4bac222366ca.txt'
INFO:     127.0.0.1:55722 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'trich_xuat_he_thong_crm.txt' đã được lưu thành công với tên 'ea168871-2e08-4bfb-a649-f6321184a84e.txt'
INFO:     127.0.0.1:55722 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'ho_so_phap_ly_doanh_nghiep.txt' đã được lưu thành công với tên '64b42aad-4734-45f2-b7f1-dceb62d5733c.txt'
INFO:     127.0.0.1:55722 - "POST /upload_file HTTP/1.1" 200 OK
INFO:     127.0.0.1:55722 - "OPTIONS /process_prompt HTTP/1.1" 200 OK
INFO: HTTP Request: DELETE http://localhost:6333/collections/session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb "HTTP/1.1 200 OK"
INFO: HTTP Request: PUT http://localhost:6333/collections/session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb "HTTP/1.1 200 OK"
🚀 Nhận được yêu cầu xử lý cho 4 file với prompt: 'Trích xuất thông tin theo mẫu Báo cáo thẩm định.' và template: 'new_template'
   Các File ID: ['b70f4322-3dce-4d7c-8f75-f5235d776317', '4b19fdaf-1e13-4007-9148-4bac222366ca', 'ea168871-2e08-4bfb-a649-f6321184a84e', '64b42aad-4734-45f2-b7f1-dceb62d5733c']
🚀 New collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
Đọc file:   0%|          | 0/4 [00:00<?, ?it/s]Đọc file:  25%|██▌       | 1/4 [00:00<00:02,  1.35it/s]Đọc file:  50%|█████     | 2/4 [00:00<00:00,  2.69it/s]Đọc file:  75%|███████▌  | 3/4 [00:01<00:00,  3.61it/s]Đọc file: 100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
INFO: HTTP Request: PUT http://localhost:6333/collections/session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb/points?wait=true "HTTP/1.1 200 OK"
⏳ Embedding & ghi Qdrant …
✅ Hoàn tất collection session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
Các file đã được embedding vào collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
Sử dụng danh sách trường cho MẪU MỚI.
🚀 Bắt đầu quá trình trích xuất thông tin từ collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' cho template 'new_template'...

--- VÒNG LẶP 1/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất, Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 2/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: BBC (Báo cáo bởi), CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 3/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: BBC (Báo cáo bởi)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 4/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: CBC (Cán bộ chính), ID đề xuất
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 5/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: CBC (Cán bộ chính)
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 6/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID đề xuất
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 7/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày báo cáo, Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 8/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày báo cáo
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 9/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Ngày cập nhật, Mục đích thẩm định
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 10/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày cập nhật
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 11/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Mục đích thẩm định
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 12/20 | Đang xử lý lô 6 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 6 trường: Cấp nơi, ID T24, Xếp hạng tín dụng, Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 13/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Cấp nơi, ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 14/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Cấp nơi
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 15/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: ID T24, Xếp hạng tín dụng
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 16/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: ID T24
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 17/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Xếp hạng tín dụng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 18/20 | Đang xử lý lô 3 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 3 trường: Ngày xếp hạng, Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...

--- VÒNG LẶP 19/20 | Đang xử lý lô 1 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 1 trường: Ngày xếp hạng
  -> Lô quá nhỏ, không chia nữa.

--- VÒNG LẶP 20/20 | Đang xử lý lô 2 trường ---
  - Đang gửi yêu cầu tới Langflow, ghi đè collection thành: 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb'
  - Lỗi kết nối tới Langflow: 500 Server Error: Internal Server Error for url: http://localhost:7860/api/v1/run/70017ce4-caba-479c-a03c-067faebf3c6c
  - Không tìm thấy 2 trường: Kết quả phân nhóm tiếp cận, Ngành
  -> Chia nhỏ lô thất bại...


✅ Quá trình trích xuất hoàn tất!
🔄 Cấu trúc lại dữ liệu cho mẫu mới...
INFO:     127.0.0.1:55722 - "POST /process_prompt HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'config.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [67631]
INFO:     Started server process [72635]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
🧠 Đang tải / khởi tạo embedding model …
✅ Embedding model sẵn sàng.
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54302 - "POST /clear_rag_session HTTP/1.1" 200 OK
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54326 - "POST /clear_rag_session HTTP/1.1" 200 OK
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54336 - "POST /clear_rag_session HTTP/1.1" 200 OK
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54348 - "POST /clear_rag_session HTTP/1.1" 200 OK
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54362 - "POST /clear_rag_session HTTP/1.1" 200 OK
🧹 Nhận yêu cầu dọn dẹp RAG collection: session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb
✅ RAG Collection 'session-3cc291a1-9bcc-4d09-81ee-f6d752d095cb' đã được xóa thành công.
INFO:     127.0.0.1:54372 - "POST /clear_rag_session HTTP/1.1" 200 OK
INFO:     127.0.0.1:54672 - "POST /clear_rag_session HTTP/1.1" 422 Unprocessable Entity
✅ File 'bao_cao_tai_chinh_va_ke_hoach_kinh_doanh.txt' đã được lưu thành công với tên '0e77b2d9-796a-4e06-bf05-a15b235227ca.txt'
INFO:     127.0.0.1:33742 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'trich_xuat_he_thong_crm.txt' đã được lưu thành công với tên '55abda4b-edf5-4df8-a80d-5fc8e10a2368.txt'
INFO:     127.0.0.1:33742 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'ho_so_phap_ly_doanh_nghiep.txt' đã được lưu thành công với tên '1b653aac-3a52-494c-8514-ffd5980a2c42.txt'
INFO:     127.0.0.1:33742 - "POST /upload_file HTTP/1.1" 200 OK
✅ File 'to_trinh_tin_dung.txt' đã được lưu thành công với tên '8dfc9c9c-f25e-4ab5-9ebd-1ee39378cfe6.txt'
INFO:     127.0.0.1:33742 - "POST /upload_file HTTP/1.1" 200 OK
🚀 Nhận được yêu cầu xử lý cho 4 file với prompt: 'Trích xuất thông tin theo mẫu Báo cáo thẩm định.' và template: 'new_template'
   Các File ID: ['0e77b2d9-796a-4e06-bf05-a15b235227ca', '55abda4b-edf5-4df8-a80d-5fc8e10a2368', '1b653aac-3a52-494c-8514-ffd5980a2c42', '8dfc9c9c-f25e-4ab5-9ebd-1ee39378cfe6']
🚀 New collection: session-5b79c447-3e1b-42e4-8f97-57b9492b73e1
Đọc file:   0%|          | 0/4 [00:00<?, ?it/s]Đọc file:  25%|██▌       | 1/4 [00:09<00:28,  9.43s/it]Đọc file: 100%|██████████| 4/4 [00:09<00:00,  2.37s/it]
/root/chatbot/backend/utils/embedding_handler.py:92: LangChainDeprecationWarning: The class `Qdrant` was deprecated in LangChain 0.1.2 and will be removed in 0.5.0. Use :class:`~QdrantVectorStore` instead.
  qstore = Qdrant(
INFO: HTTP Request: PUT http://localhost:6333/collections/session-5b79c447-3e1b-42e4-8f97-57b9492b73e1/points?wait=true "HTTP/1.1 404 Not Found"
⏳ Embedding & ghi Qdrant …
❌ Lỗi nghiêm trọng trong quá trình xử lý: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `session-5b79c447-3e1b-42e4-8f97-57b9492b73e1` doesn\'t exist!"},"time":0.001559144}'
INFO:     127.0.0.1:33742 - "POST /process_prompt HTTP/1.1" 500 Internal Server Error
/root/miniconda3/envs/chatbot_env/lib/python3.10/multiprocessing/resource_tracker.py:224: UserWarning: resource_tracker: There appear to be 3 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
